<!doctype html>
<html>
  <head>
    <meta charset=utf8>
  </head>
  <body>
    <h1>CodeMirror!</h1>
    <div id="editor"></div>
    <script src="cm6.min.js"></script>
    <script>
     const doc = `
<!doctype html>
<html>
  <head>
    <title>Home</title>
  </head>
  <body>
    <h1>Home</h1>
    <p>This is the home page.</p>
  </body>
</html>
     `.trim()

     const fixedHeightEditor = CM6.EditorView.theme({
         "&": {height: "300px"},
         ".cm-scroller": {overflow: "auto"}
     })

     function myCompletions(context) {
         let word = context.matchBefore(/\w*/)
         if (word.from == word.to && !context.explicit)
             return null
         return {
             from: word.from,
             options: [
                 {label: "match", type: "keyword"},
                 {label: "hello", type: "variable", info: "(World)"},
                 {label: "magic", type: "text", apply: "⠁⭒*.✩.*⭒⠁", detail: "macro"}
             ]
         }
     }

     function statusPanel(view) {
         let dom = document.createElement("div")
         dom.id = 'status';
         dom.textContent = 'Ready';
         return {dom}
     }

     let state = CM6.EditorState.create({
         doc: doc,
         extensions: [
             CM6.basicSetup,
             CM6.indentationMarkers(),
             CM6.keymap.of([CM6.indentWithTab]),
             CM6.autocompletion({override: [myCompletions]}),
             CM6.EditorView.lineWrapping,
             fixedHeightEditor,
             CM6.showPanel.of(statusPanel),
             CM6Html.html()
         ],
     })

     var editor = new CM6.EditorView({
         state: state,
         parent: document.querySelector("#editor")
     })
    </script>
  </body>
</html>
